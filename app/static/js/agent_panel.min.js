function baseOrderList(){fetch("/api/v1/agent_base_orders").then((res=>res.json())).then((json=>{if(0==json.code){const orderData=json.data,goods=document.getElementById("goods");for(const iterator of orderData){const option=`<option value="${iterator.orderId}">${iterator.goodName}</option>`;goods.innerHTML+=option}}}))}function updateEmployeeInfo(){const employee_id_number=document.getElementById("employee_id_number"),today_id0=document.getElementById("today_id0"),history_id0=document.getElementById("history_id0"),today_id1=document.getElementById("today_id1"),history_id1=document.getElementById("history_id1"),today_id2=document.getElementById("today_id2"),history_id2=document.getElementById("history_id2"),today_id3=document.getElementById("today_id3"),history_id3=document.getElementById("history_id3");fetch("/api/v1/getEmployee").then((res=>res.json())).then((json=>{0==json.code&&(document.getElementById("loginPage").style.display="none",employee_id_number.innerHTML=json.data.employee_id,today_id0.innerHTML=json.data.conversion_count,today_id1.innerHTML=json.data.orderCount,history_id0.innerHTML=json.data.history.conversionCount,history_id1.innerHTML=json.data.history.orderCount,today_id2.innerHTML=json.data.amount.toFixed(2),history_id2.innerHTML=json.data.history.amount.toFixed(2),today_id3.innerHTML=(.6*json.data.amount+1*json.data.conversion_count).toFixed(2),history_id3.innerHTML=(.6*json.data.history.amount+1*json.data.history.conversionCount).toFixed(2))}))}function e_login(){const eid=document.getElementById("employee_id");if(!eid.value)return alert("eid is required."),-1;const options={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({employee_id:eid.value})};fetch("/api/v1/employee_login",options).then((res=>res.json())).then((json=>{0!=json.code?alert("Login failed"):(document.getElementById("loginPage").style.display="none",updateEmployeeInfo())}))}window.onload=()=>{updateEmployeeInfo(),baseOrderList(),setInterval((()=>{updateEmployeeInfo()}),2e3)};let requestOrderButton=document.getElementById("requestOrderButton"),requestOrderProcessing=!1;function create_order(){const goods=document.getElementById("goods");if(!goods.value)return alert("Empty"),-1;requestOrderProcessing&&(alert("Processing..."),retrun),requestOrderProcessing=!0,requestOrderButton.innerHTML="正在处理...";const options={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({base_order_id:goods.value})};fetch("/api/v1/agent_create_order",options).then((res=>res.json())).then((json=>{if(0==json.code){const feedData=json.data,linkElement=document.getElementById("order_link"),domainName=document.domain,template_index=2;linkElement.innerHTML=`https://${domainName}/template/${template_index}?feed_id=${feedData.feedId}`,document.getElementById("order_result").style.display="flex"}else alert("订单创建失败，如果多次失败请联系你的老板");requestOrderButton.innerHTML="申请订单",requestOrderProcessing=!1})).catch((_err=>{requestOrderButton.innerHTML="申请订单",requestOrderProcessing=!1}))}function close_order_result(){document.getElementById("order_result").style.display="none"}